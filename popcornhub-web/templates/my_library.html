{% extends "base.html" %}
{% block title %}Ma vidéothèque{% endblock %}

{% block content %}
<h1 class="mb-4">Ma vidéothèque</h1>

{% if library_ownerships|length == 0 %}
    <p class="text-light">
      Vous n'avez pas encore ajouté de films à votre vidéothèque.
    </p>
  {% endif %}

  <div class="row g-4">
    {% for item in library_ownerships %}
      {% set film = item.film %}
      {% set own = item.own %}

      <div class="col-md-6 col-lg-4">
        <div class="card bg-dark border-secondary h-100 shadow-sm">
          {% if film.affiche_url %}
            <img src="{{ film.affiche_url }}"
                 class="card-img-top"
                 style="object-fit:cover;height:260px;"
                 alt="Affiche de {{ film.titre }}">
          {% endif %}

          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h5 class="card-title mb-0">{{ film.titre }}</h5>
              {% if item.is_public %}
                <span class="badge bg-success">Publique</span>
              {% else %}
                <span class="badge bg-secondary">Privée</span>
              {% endif %}
            </div>

            <form action="{{ url_for('films_bp.update_library_item', film_id=film.id) }}"
                  method="post" class="mb-2">
              ...
            </form>

            <form action="{{ url_for('toggle_library_public', film_id=film.id) }}"
                  method="post">
              <button class="btn btn-outline-light btn-sm w-100">
                {% if item.is_public %}Rendre privé{% else %}Rendre public{% endif %}
              </button>
            </form>

          </div>
        </div>
      </div>
    {% endfor %}
  </div>

{% endif %}